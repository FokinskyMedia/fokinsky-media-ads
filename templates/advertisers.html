{% extends 'base.html' %}
{% block content %}
<h2>–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–∏ 
    <a href="/advertiser/add" class="btn btn-sm btn-success">–î–æ–±–∞–≤–∏—Ç—å</a>
</h2>

<!-- –ü–û–ò–°–ö –†–ï–ö–õ–ê–ú–û–î–ê–¢–ï–õ–ï–ô -->
<div class="card mb-4">
    <div class="card-body">
        <form method="get" action="/advertisers" class="row g-2">
            <div class="col-md-10">
                <input type="text" name="search" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–º–ø–∞–Ω–∏–∏..." value="{{ search_query }}">
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">–ù–∞–π—Ç–∏</button>
            </div>
        </form>
        {% if search_query %}
            <div class="mt-2">
                <small class="text-muted">–ù–∞–π–¥–µ–Ω–æ: {{ items.total }} —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ search_query }}"</small>
                <a href="/advertisers" class="btn btn-sm btn-outline-secondary ms-2">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        {% endif %}
    </div>
</div>

<!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–ê–ì–ò–ù–ê–¶–ò–ò -->
<div class="alert alert-info d-flex justify-content-between align-items-center py-2 mb-3">
    <small>
        üìä –ü–æ–∫–∞–∑–∞–Ω–æ: <strong>{{ items.items|length }}</strong> –∏–∑ <strong>{{ items.total }}</strong> —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π
    </small>
    {% if items.pages > 1 %}
    <small>
        üìÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞: <strong>{{ items.page }}</strong> –∏–∑ <strong>{{ items.pages }}</strong>
    </small>
    {% endif %}
</div>

<table class="table table-striped table-sm">
  <thead>
    <tr>
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
      <th>Telegram</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
  </thead>
  <tbody>
    {% for a in items.items %}
      <tr>
        <td>{{ a.name }}</td>
        <td>{{ a.telegram }}</td>
        <td>
          <a href="/advertiser/{{ a.id }}/edit" class="btn btn-sm btn-primary">–†–µ–¥.</a>
          <form action="/advertiser/{{ a.id }}/delete" method="post" style="display:inline;">
            <button class="btn btn-sm btn-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å?');">X</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{# –ü–ê–ì–ò–ù–ê–¶–ò–Ø –î–õ–Ø –†–ï–ö–õ–ê–ú–û–î–ê–¢–ï–õ–ï–ô #}
{% if items.pages > 1 %}
<div class="mt-4">
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if items.has_prev %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('advertisers', page=items.prev_num, search=search_query) }}">‚Üê –ù–∞–∑–∞–¥</a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">‚Üê –ù–∞–∑–∞–¥</span>
            </li>
            {% endif %}
            
            {% for page_num in items.iter_pages(left_edge=2, left_current=2, right_current=3, right_edge=2) %}
                {% if page_num %}
                    {% if page_num == items.page %}
                    <li class="page-item active">
                        <span class="page-link">{{ page_num }}</span>
                    </li>
                    {% else %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('advertisers', page=page_num, search=search_query) }}">{{ page_num }}</a>
                    </li>
                    {% endif %}
                {% else %}
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                {% endif %}
            {% endfor %}
            
            {% if items.has_next %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('advertisers', page=items.next_num, search=search_query) }}">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">–í–ø–µ—Ä–µ–¥ ‚Üí</span>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endif %}
{% endblock %}